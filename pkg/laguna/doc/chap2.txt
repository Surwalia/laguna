  
  [1X2 A sample calculation with [5XLAGUNA[1X[0X
  
  Before  explaining  the theory behind the [5XLAGUNA[0m package we present a sample
  calculation to show the reader what [5XLAGUNA[0m is able to compute. We will carry
  out some calculations in the group algebra of the dihedral group of order 16
  over the field of two elements. First we create this modular group algebra.
  
  [4X---------------------------  Example  ----------------------------[0X
    [4X[0X
    [4Xgap> K := GF( 2 );[0X
    [4XGF(2)[0X
    [4Xgap> G := DihedralGroup( 16 );[0X
    [4X<pc group of size 16 with 4 generators>[0X
    [4Xgap> KG := GroupRing( K, G );[0X
    [4X<algebra-with-one over GF(2), with 4 generators>[0X
    [4X[0X
  [4X------------------------------------------------------------------[0X
  
  The  group  algebra  [10XKG[0m  has  some properties and attributes that are direct
  consequences of its definition. These can be checked very quickly.
  
  [4X---------------------------  Example  ----------------------------[0X
    [4X[0X
    [4Xgap> IsGroupAlgebra( KG ); [0X
    [4Xtrue[0X
    [4Xgap> IsPModularGroupAlgebra( KG );[0X
    [4Xtrue[0X
    [4Xgap> IsFModularGroupAlgebra( KG );[0X
    [4Xtrue[0X
    [4Xgap> UnderlyingGroup( KG );[0X
    [4X<pc group of size 16 with 4 generators>[0X
    [4Xgap> LeftActingDomain( KG );[0X
    [4XGF(2)[0X
    [4X[0X
  [4X------------------------------------------------------------------[0X
  
  Since  [10XKG[0m  is  naturally  a  group  algebra,  the  information  provided  by
  [10XLeftActingDomain[0m can also be obtained using two other functions as follows.
  
  [4X---------------------------  Example  ----------------------------[0X
    [4Xgap> UnderlyingRing( KG );[0X
    [4XGF(2)[0X
    [4Xgap> UnderlyingField( KG );[0X
    [4XGF(2)[0X
  [4X------------------------------------------------------------------[0X
  
  Let  us  construct  a  certain element of the group algebra. For example, we
  take  a  minimal generating system of the group [10XG[0m and find the corresponding
  elements in [10XKG[0m.
  
  [4X---------------------------  Example  ----------------------------[0X
    [4X[0X
    [4Xgap> MinimalGeneratingSet( G );[0X
    [4X[ f1, f2 ][0X
    [4Xgap> l := List( last, g -> g^Embedding( G, KG ) );[0X
    [4X[ (Z(2)^0)*f1, (Z(2)^0)*f2 ][0X
    [4X[0X
  [4X------------------------------------------------------------------[0X
  
  Now we construct an element [10Xx[0m as follows.
  
  [4X---------------------------  Example  ----------------------------[0X
    [4X[0X
    [4Xgap> a :=l[1]; b:=l[2]; # a and b are images of group generators in KG[0X
    [4X(Z(2)^0)*f1[0X
    [4X(Z(2)^0)*f2[0X
    [4Xgap> e := One( KG );    # for convenience, we denote the identity by e[0X
    [4X(Z(2)^0)*<identity> of ...[0X
    [4Xgap> x := ( e + a ) * ( e + b ); [0X
    [4X(Z(2)^0)*<identity> of ...+(Z(2)^0)*f1+(Z(2)^0)*f2+(Z(2)^0)*f1*f2  [0X
    [4X[0X
  [4X------------------------------------------------------------------[0X
  
  We may investigate some of the basic properties of our element.
  
  [4X---------------------------  Example  ----------------------------[0X
    [4X[0X
    [4Xgap> Support( x );[0X
    [4X[ <identity> of ..., f1, f2, f1*f2 ][0X
    [4Xgap> CoefficientsBySupport( x );[0X
    [4X[ Z(2)^0, Z(2)^0, Z(2)^0, Z(2)^0 ][0X
    [4Xgap> Length( x );[0X
    [4X4[0X
    [4Xgap> TraceOfMagmaRingElement( x );[0X
    [4XZ(2)^0[0X
    [4X[0X
  [4X------------------------------------------------------------------[0X
  
  We  can also calculate the augmentation of [10Xx[0m, which is defined as the sum of
  its coefficients.
  
  [4X---------------------------  Example  ----------------------------[0X
    [4Xgap> Augmentation( x );[0X
    [4X0*Z(2)[0X
    [4Xgap> IsUnit( KG, x );[0X
    [4Xfalse[0X
  [4X------------------------------------------------------------------[0X
  
  Since  the  augmentation of [10Xx[0m is zero, [10Xx[0m is not invertible, but [10X1+x[0m is. This
  is again very easy to check.
  
  [4X---------------------------  Example  ----------------------------[0X
    [4X[0X
    [4Xgap> y := e + x;[0X
    [4X(Z(2)^0)*f1+(Z(2)^0)*f2+(Z(2)^0)*f1*f2[0X
    [4Xgap> IsUnit( KG, y );[0X
    [4Xtrue  [0X
    [4X[0X
  [4X------------------------------------------------------------------[0X
  
  [5XLAGUNA[0m can calculate the inverse of [10X1+x[0m very quickly.
  
  [4X---------------------------  Example  ----------------------------[0X
    [4X[0X
    [4Xgap> y^-1;[0X
    [4X(Z(2)^0)*f1+(Z(2)^0)*f2+(Z(2)^0)*f3+(Z(2)^0)*f4+(Z(2)^0)*f1*f2+(Z(2)^[0X
    [4X0)*f1*f3+(Z(2)^0)*f1*f4+(Z(2)^0)*f2*f4+(Z(2)^0)*f1*f2*f4+(Z(2)^0)*f2*f3*f4+([0X
    [4XZ(2)^0)*f1*f2*f3*f4[0X
    [4Xgap> y * y^-1;[0X
    [4X(Z(2)^0)*<identity> of ... [0X
    [4X[0X
  [4X------------------------------------------------------------------[0X
  
  We  may  also  want  to check whether [10Xy[0m is symmetric, that is, whether it is
  invariant under the classical involution; or whether it is unitary, that is,
  whether the classical involution inverts [10Xy[0m. We find that [10Xy[0m is neither.
  
  [4X---------------------------  Example  ----------------------------[0X
    [4X[0X
    [4Xgap> Involution( y );[0X
    [4X(Z(2)^0)*f1+(Z(2)^0)*f1*f2+(Z(2)^0)*f2*f3*f4[0X
    [4Xgap> y = Involution( y );[0X
    [4Xfalse[0X
    [4Xgap> IsSymmetric( y );[0X
    [4Xfalse[0X
    [4Xgap> y * Involution( y );[0X
    [4X(Z(2)^0)*<identity> of ...+(Z(2)^0)*f2+(Z(2)^0)*f2*f3*f4  [0X
    [4Xgap> IsUnitary( y );[0X
    [4Xfalse[0X
    [4X[0X
  [4X------------------------------------------------------------------[0X
  
  Now  we  calculate  some  important  ideals  of  [10XKG[0m.  First  we  obtain  the
  augmentation  ideal  which is the set of elements with augmentation zero. In
  our  case the augmentation ideal of [10XKG[0m coincides with the radical of [10XKG[0m, and
  this is taken into account in [5XLAGUNA[0m.
  
  [4X---------------------------  Example  ----------------------------[0X
    [4X[0X
    [4Xgap> AugmentationIdeal( KG );[0X
    [4X<two-sided ideal in <algebra-with-one over GF(2), with 4 generators>,[0X
    [4X  (dimension 15)>[0X
    [4Xgap> RadicalOfAlgebra( KG ) = AugmentationIdeal( KG );[0X
    [4Xtrue[0X
    [4X[0X
  [4X------------------------------------------------------------------[0X
  
  It  is  well-known  that  the augmentation ideal of [10XKG[0m is a nilpotent ideal.
  Using  Jennings' theory on dimension subgroups, we can obtain its nilpotency
  index  without  immediate  calculation of its powers. This is implemented in
  [5XLAGUNA[0m.
  
  [4X---------------------------  Example  ----------------------------[0X
    [4Xgap> AugmentationIdealNilpotencyIndex( KG );[0X
    [4X9[0X
  [4X------------------------------------------------------------------[0X
  
  On  the  other  hand,  we  can also calculate the powers of the augmentation
  ideal.
  
  [4X---------------------------  Example  ----------------------------[0X
    [4X[0X
    [4Xgap> AugmentationIdealPowerSeries( KG );[0X
    [4X[ <algebra of dimension 15 over GF(2)>, <algebra of dimension 13 over GF(2)>, [0X
    [4X  <algebra of dimension 11 over GF(2)>, <algebra of dimension 9 over GF(2)>, [0X
    [4X  <algebra of dimension 7 over GF(2)>, <algebra of dimension 5 over GF(2)>, [0X
    [4X  <algebra of dimension 3 over GF(2)>, <algebra of dimension 1 over GF(2)>, [0X
    [4X  <algebra over GF(2)> ][0X
    [4X[0X
  [4X------------------------------------------------------------------[0X
  
  We  see  that the length of this list is exactly the nilpotency index of the
  augmentation ideal of [10XKG[0m.
  
  Now  let's work with the unit group of [10XKG[0m. First we calculate the normalized
  unit  group,  which  is  the  set  of  elements  with  augmentation one. The
  generators  of  the  unit group are obtained as explained in Chapter [14X3[0m. This
  can  be  computed  very  quickly, but further computation with this group is
  very inefficient.
  
  [4X---------------------------  Example  ----------------------------[0X
    [4X[0X
    [4Xgap> V := NormalizedUnitGroup( KG );[0X
    [4X<group of size 32768 with 15 generators>   [0X
    [4X[0X
  [4X------------------------------------------------------------------[0X
  
  In  order to make our computation in the normalised unit group efficient, we
  calculate a power-commutator presentation for this group.
  
  [4X---------------------------  Example  ----------------------------[0X
    [4X[0X
    [4Xgap> W := PcNormalizedUnitGroup( KG );[0X
    [4X<pc group of size 32768 with 15 generators>[0X
    [4X[0X
  [4X------------------------------------------------------------------[0X
  
  [5XGAP[0m  has  many  efficient  and  practical  algorithms  for groups given by a
  power-commutator presentation. In order to use these algorithms to carry out
  computation  in  the  normalised  unit group, we need to set up isomorphisms
  between the outputs of [10XNormalizedUnitGroup[0m and [10XPcNormalizedUnitGroup[0m.
  
  The  first  isomorphism maps [10XNormalizedUnitGroup(KG)[0m onto the polycyclically
  presented  [10XPcNormalizedUnitGroup(PC)[0m.  Let's find the images of the elements
  of the group [10XG[0m in [10XW[0m.
  
  [4X---------------------------  Example  ----------------------------[0X
    [4X[0X
    [4Xgap> t := NaturalBijectionToPcNormalizedUnitGroup( KG );[0X
    [4XMappingByFunction( <group of size 32768 with[0X
    [4X15 generators>, <pc group of size 32768 with[0X
    [4X15 generators>, function( x ) ... end )[0X
    [4Xgap> List( AsList( G ), x -> ( x^Embedding( G, KG ) )^t );[0X
    [4X[ <identity> of ..., f2, f1, f3, f7, f1*f2*f3, f2*f3, f2*f7, f1*f3, f1*f7,[0X
    [4X  f3*f7, f1*f2*f7, f1*f2*f3*f7, f2*f3*f7, f1*f3*f7, f1*f2 ][0X
    [4X[0X
  [4X------------------------------------------------------------------[0X
  
  The second isomorphism is the inverse of the first.
  
  [4X---------------------------  Example  ----------------------------[0X
    [4Xgap> f := NaturalBijectionToNormalizedUnitGroup( KG );[0X
    [4X[ f1, f2, f3, f4, f5, f6, f7, f8, f9, f10, f11, f12, f13, f14, f15 ] ->[0X
    [4X[ (Z(2)^0)*f2, (Z(2)^0)*f1, (Z(2)^0)*f3,[0X
    [4X  (Z(2)^0)*f1+(Z(2)^0)*f2+(Z(2)^0)*f1*f2,[0X
    [4X  (Z(2)^0)*f2+(Z(2)^0)*f3+(Z(2)^0)*f2*f3,[0X
    [4X  (Z(2)^0)*f1+(Z(2)^0)*f3+(Z(2)^0)*f1*f3, (Z(2)^0)*f4,[0X
    [4X  (Z(2)^0)*f1+(Z(2)^0)*f2+(Z(2)^0)*f3+(Z(2)^0)*f1*f2+(Z(2)^0)*f1*f3+(Z(2)^[0X
    [4X    0)*f2*f3+(Z(2)^0)*f1*f2*f3, (Z(2)^0)*f2+(Z(2)^0)*f4+(Z(2)^0)*f2*f4,[0X
    [4X  (Z(2)^0)*f1+(Z(2)^0)*f4+(Z(2)^0)*f1*f4,[0X
    [4X  (Z(2)^0)*f3+(Z(2)^0)*f4+(Z(2)^0)*f3*f4,[0X
    [4X  (Z(2)^0)*f1+(Z(2)^0)*f2+(Z(2)^0)*f4+(Z(2)^0)*f1*f2+(Z(2)^0)*f1*f4+(Z(2)^[0X
    [4X    0)*f2*f4+(Z(2)^0)*f1*f2*f4, (Z(2)^0)*f2+(Z(2)^0)*f3+(Z(2)^0)*f4+(Z(2)^[0X
    [4X    0)*f2*f3+(Z(2)^0)*f2*f4+(Z(2)^0)*f3*f4+(Z(2)^0)*f2*f3*f4,[0X
    [4X  (Z(2)^0)*f1+(Z(2)^0)*f3+(Z(2)^0)*f4+(Z(2)^0)*f1*f3+(Z(2)^0)*f1*f4+(Z(2)^[0X
    [4X    0)*f3*f4+(Z(2)^0)*f1*f3*f4, (Z(2)^0)*f1+(Z(2)^0)*f2+(Z(2)^0)*f3+(Z(2)^[0X
    [4X    0)*f4+(Z(2)^0)*f1*f2+(Z(2)^0)*f1*f3+(Z(2)^0)*f1*f4+(Z(2)^0)*f2*f3+(Z(2)^[0X
    [4X    0)*f2*f4+(Z(2)^0)*f3*f4+(Z(2)^0)*f1*f2*f3+(Z(2)^0)*f1*f2*f4+(Z(2)^[0X
    [4X    0)*f1*f3*f4+(Z(2)^0)*f2*f3*f4+(Z(2)^0)*f1*f2*f3*f4 ][0X
  [4X------------------------------------------------------------------[0X
  
  For example, we may calculate the conjugacy classes of the group [10XW[0m, and then
  map their representatives back into the group algebra.
  
  [4X---------------------------  Example  ----------------------------[0X
    [4X[0X
    [4Xgap> cc := ConjugacyClasses( W );;[0X
    [4Xgap> Length( cc );[0X
    [4X848[0X
    [4Xgap> Representative( cc[ Length( cc ) ] );[0X
    [4Xf1*f2*f4*f6*f12*f15[0X
    [4Xgap> last^f;[0X
    [4X(Z(2)^0)*<identity> of ...+(Z(2)^0)*f2+(Z(2)^0)*f4+(Z(2)^0)*f1*f2+(Z(2)^[0X
    [4X0)*f1*f3+(Z(2)^0)*f1*f4+(Z(2)^0)*f2*f3+(Z(2)^0)*f2*f4+(Z(2)^0)*f3*f4+(Z(2)^[0X
    [4X0)*f1*f2*f3+(Z(2)^0)*f1*f3*f4[0X
    [4X[0X
  [4X------------------------------------------------------------------[0X
  
  Having  a power-commutator presentation of the normalised unit group, we may
  use  the  full  power of the [5XGAP[0m functionality for such groups. For example,
  the lower central series can be calculated very quickly.
  
  [4X---------------------------  Example  ----------------------------[0X
    [4X[0X
    [4Xgap> LowerCentralSeries( W );[0X
    [4X[ <pc group of size 32768 with 15 generators>,[0X
    [4X  Group([ f3, f5*f8*f10*f12*f13*f14*f15, f6*f8*f12*f14*f15, f7, f9*f12,[0X
    [4X      f10*f14, f11*f13, f13*f14, f14*f15 ]),[0X
    [4X  Group([ f7, f9*f12, f10*f15, f11*f15, f13*f15, f14*f15 ]),[0X
    [4X  Group([ f11*f15, f13*f15, f14*f15 ]), Group([ <identity> of ... ]) ][0X
    [4X[0X
  [4X------------------------------------------------------------------[0X
  
  Let's  now  compute,  for  instance,  a  minimal system of generators of the
  centre  of  the normalised unit group. First we carry out the computation in
  the  group which is determined by the power-commutator presentation, then we
  map the result into our group algebra.
  
  [4X---------------------------  Example  ----------------------------[0X
    [4X[0X
    [4Xgap> C := Centre( W );[0X
    [4XGroup([ f3*f5*f13*f15, f7, f15, f13*f15, f14*f15, f11*f13*f14*f15 ])[0X
    [4Xgap> m := MinimalGeneratingSet( C );[0X
    [4X[ f7*f13*f14*f15, f13*f14*f15, f7*f11*f14*f15, f15, f3*f5*f14 ][0X
    [4Xgap> List( m, g -> g^f );[0X
    [4X[ (Z(2)^0)*<identity> of ...+(Z(2)^0)*f3+(Z(2)^0)*f1*f2+(Z(2)^0)*f3*f4+(Z(2)^[0X
    [4X    0)*f1*f2*f3+(Z(2)^0)*f1*f2*f4+(Z(2)^0)*f1*f2*f3*f4,[0X
    [4X  (Z(2)^0)*f3+(Z(2)^0)*f4+(Z(2)^0)*f1*f2+(Z(2)^0)*f3*f4+(Z(2)^0)*f1*f2*f3+([0X
    [4X    Z(2)^0)*f1*f2*f4+(Z(2)^0)*f1*f2*f3*f4, (Z(2)^0)*<identity> of ...+(Z(2)^[0X
    [4X    0)*f2+(Z(2)^0)*f3+(Z(2)^0)*f1*f2+(Z(2)^0)*f2*f3+(Z(2)^0)*f2*f4+(Z(2)^[0X
    [4X    0)*f3*f4+(Z(2)^0)*f1*f2*f3+(Z(2)^0)*f1*f2*f4+(Z(2)^0)*f2*f3*f4+(Z(2)^[0X
    [4X    0)*f1*f2*f3*f4, (Z(2)^0)*f1+(Z(2)^0)*f2+(Z(2)^0)*f3+(Z(2)^0)*f4+(Z(2)^[0X
    [4X    0)*f1*f2+(Z(2)^0)*f1*f3+(Z(2)^0)*f1*f4+(Z(2)^0)*f2*f3+(Z(2)^0)*f2*f4+([0X
    [4X    Z(2)^0)*f3*f4+(Z(2)^0)*f1*f2*f3+(Z(2)^0)*f1*f2*f4+(Z(2)^0)*f1*f3*f4+(Z(2)^[0X
    [4X    0)*f2*f3*f4+(Z(2)^0)*f1*f2*f3*f4, (Z(2)^0)*<identity> of ...+(Z(2)^0)*f1+([0X
    [4X    Z(2)^0)*f3+(Z(2)^0)*f1*f3+(Z(2)^0)*f1*f4+(Z(2)^0)*f2*f3+(Z(2)^0)*f2*f4+([0X
    [4X    Z(2)^0)*f3*f4+(Z(2)^0)*f1*f3*f4 ][0X
    [4X[0X
  [4X------------------------------------------------------------------[0X
  
  We  finish  our  example  by  calculating some properties of the Lie algebra
  associated with [10XKG[0m. This example needs no further explanation.
  
  [4X---------------------------  Example  ----------------------------[0X
    [4X[0X
    [4Xgap> L := LieAlgebra( KG );[0X
    [4X#I  LAGUNA package: Constructing Lie algebra ...[0X
    [4X<Lie algebra over GF(2)>[0X
    [4Xgap> D := LieDerivedSubalgebra( L );[0X
    [4X#I  LAGUNA package: Computing the Lie derived subalgebra ...[0X
    [4X<Lie algebra of dimension 9 over GF(2)>[0X
    [4Xgap> LC := LieCentre( L );[0X
    [4X<Lie algebra of dimension 7 over GF(2)>[0X
    [4Xgap> LieLowerNilpotencyIndex( KG );[0X
    [4X5[0X
    [4Xgap> LieUpperNilpotencyIndex( KG );[0X
    [4X5[0X
    [4Xgap> IsLieAbelian( L );[0X
    [4Xfalse[0X
    [4Xgap> IsLieSolvable( L );[0X
    [4X#I  LAGUNA package: Checking Lie solvability ...[0X
    [4Xtrue[0X
    [4Xgap> IsLieMetabelian( L );[0X
    [4Xfalse[0X
    [4Xgap> IsLieCentreByMetabelian( L );[0X
    [4Xtrue[0X
    [4X[0X
  [4X------------------------------------------------------------------[0X
  
